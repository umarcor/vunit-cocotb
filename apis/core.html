

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Core &mdash; Open Source Verification Bundle latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/osvb.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Project" href="project.html" />
    <link rel="prev" title="Co-simulation" href="../intro/cosim.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logow.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/frameworks.html">Frameworks and Methodologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/sim.html">Simulators | Compilers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/cosim.html">Co-simulation</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="tool.html">Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="runner.html">Runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../egs/sff.html">Simple Flip-Flop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../egs/axi4stream.html">SISO AXI4 Stream</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebook</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebook/fpconv.html">Fixed-point conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook/sigrok.html">sigrok-cli | Pulseview</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Open Source Verification Bundle</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
            

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/umarcor/osvb/blob/master/doc/apis/core.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core">
<span id="osvb-api-core"></span><h1>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://hdl.github.io/awesome/items/fusesoc/">FuseSoC</a> is a package manager and build abstraction tool for FPGA/ASIC
development, written in Python. It is based on a declarative data sctructure, defined as a YAML configuration file format
named Core API (CAPI). The current version 2 of the format is named <code class="docutils literal notranslate"><span class="pre">CAPI2</span></code> (see <a class="reference external" href="https://fusesoc.rtfd.io/en/latest/ref/capi2.html">fusesoc.rtfd.io: ref/capi2</a>).
A single YAML file can be used for defining all the sources and parameters related to multiple tools for simulation, verification,
synthesis, etc.</p>
<p>Initially, FuseSoC was a monolith that allowed interacting with FPGA/ASIC tools directly. Later, <a class="reference external" href="https://hdl.github.io/awesome/items/edalize/">Edalize</a>
was split, and an API named EDA Metadata (EDAM) was proposed for the interaction from FuseSoC or other frontends.
<a class="reference external" href="https://hdl.github.io/awesome/items/hdlmake/">Hdlmake</a> is one of the projects that can use Edalize through EDAM.</p>
<p>Nevertheless, the proposal for funneling all open source project management tools through Edalize didn’t engage the
broad open source hardware tooling community. Multiple projects (such as
<a class="reference external" href="https://hdl.github.io/awesome/items/vunit/">VUnit</a>,
<a class="reference external" href="https://hdl.github.io/awesome/items/pyipcmi/">pyIPCMI</a>,
<a class="reference external" href="https://hdl.github.io/awesome/items/pyfpga/">PyFPGA</a>,
<a class="reference external" href="https://hdl.github.io/awesome/items/tsfpga/">tsfpga</a>
or
<a class="reference external" href="https://hdl.github.io/awesome/items/xeda/">Xeda</a>
) provide independent APIs and CLIs for interacting with FPGA/ASIC tools. Most of them are also standalone monoliths with
custom configuration file formats. Therefore, workflows are not compatible, and users need duplicated configurations for
addressing the requirements of each tool.</p>
<p>There have been some integration efforts; for instance, supporting VUnit scripts as FuseSoC/Edalize targets. However, there
is a paradigm conflict, since FuseSoC expects to be the entrypoint and Edalize is to be the backend. Therefore, integration
of other tools is only conceived as plugins in the already constrained framework. Doing so breaks the workflows that the user
bases of other projects do rely on.</p>
<p>The proposal in this bundle is to provide a reusable Python module named pyCAPI, for reading CAPI files and manipulating the
data through a pythonic API. pyCAPI allows FPGA/ASIC tool management projects to consume <code class="docutils literal notranslate"><span class="pre">*.core</span></code> configuration files
non-intrusively, by providing complementary import APIs. Thus the CLIs in the existing workflows are preserved,
without forcing FuseSoC as a frontend and/or Edalize as a backend. Hopefully, pyCAPI reduces the burden for users to try and
learn new tools, while developers/maintainers can carefully analyse possible integration strategies with regard to the other
APIs in the architecture.</p>
<div class="figure align-center" id="id1">
<img alt="pyCAPI usage block diagram" src="../_images/pyCAPI.png" />
<p class="caption"><span class="caption-text">Usage of pyCAPI as a utility library for multiple EDA management projects.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>FuseSoC does contain some Python code for reading and parsing CAPI2 files (see <a class="reference external" href="https://github.com/olofk/fusesoc/tree/master/fusesoc/capi2">olofk/fusesoc: fusesoc/capi2</a>).
Unfortunately, it is challenging to work with. On the one hand, it uses <a class="reference external" href="https://pyyaml.org/">pyyaml</a> for reading <code class="docutils literal notranslate"><span class="pre">*.core</span></code>
files as Python dictionaries and lists. As a result, the procedure for providing Python classes is manual and prone to error.
On the other hand, the format is documented in the sources of the code, but the code itself is undocumented.</p>
<p>Conversely, pyCAPI is based on Python <a class="reference external" href="https://docs.python.org/3/library/dataclasses.html#module-dataclasses" title="(in Python v3.9)"><code class="docutils literal notranslate"><span class="pre">dataclasses</span></code></a> for direct (un)marshalling of YAML to/from Python classes.
Hence, the CAPI2 format is not supported as-is yet: some non compliant fields were modified, and the prototype is limited
to reading filesets. This work-in-progress version of CAPI is marked as <code class="docutils literal notranslate"><span class="pre">3</span></code>, for avoiding conflicts with existing <code class="docutils literal notranslate"><span class="pre">*.core</span></code>
files. Still, pyCAPI does already allow VUnit to read <code class="docutils literal notranslate"><span class="pre">*.core</span></code> files for declaring HDL sources and the <code class="docutils literal notranslate"><span class="pre">logical_name</span></code> of
the libraries where they need to be compiled. I.e., it allows providing a working proof of concept, constrainted to the
simulation/verification scope of this bundle.</p>
<p>Feedback and contributions for making pyCAPI compatible with and supported by FuseSoC, VUnit, PyFPGA, pyIPCMI, etc. are very
welcome! <a class="reference external" href="https://github.com/umarcor/osvb/issues/new/choose">Open an issue</a> or <a class="reference external" href="https://gitter.im/hdl/community">join the chat</a>!</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/yukihiko-shinoda/yaml-dataclass-config">yukihiko-shinoda/yaml-dataclass-config</a></p></li>
<li><p><a class="reference external" href="http://su0.io/2020/08/05/python-strict-yaml-deserialization.html">su0.io: Strict YAML deserialization with marshmallow</a></p></li>
<li><p><a class="reference external" href="https://github.com/antonblanchard/microwatt/blob/master/microwatt.core">antonblanchard/microwatt: microwatt.core</a></p></li>
<li><p><a class="reference external" href="https://github.com/VLSI-EDA/PoC/tree/master/.pyIPCMI">VLSI-EDA/PoC: .pyIPCMI</a></p></li>
<li><p><a class="reference external" href="https://docs.google.com/document/d/1DWZ0G8vehkuZTPs5N3AQqIvZZtLMGzC8i0MWPRP54O4">j.mp/openfpga-diagram: Open Source (FOSS) FPGA (EDA) Tooling Interchange Formats + Toolchain parts</a></p></li>
</ul>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyCAPI.IpCoreConfig">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyCAPI.</span></code><code class="sig-name descname"><span class="pre">IpCoreConfig</span></code><a class="reference internal" href="../_modules/pyCAPI.html#IpCoreConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyCAPI.IpCoreConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Each core file must contain an ‘ipcore’ field with the metadata of the design.</p>
<dl class="py attribute">
<dt id="pyCAPI.IpCoreConfig.name">
<code class="sig-name descname"><span class="pre">name</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.IpCoreConfig.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.IpCoreConfig.namespace">
<code class="sig-name descname"><span class="pre">namespace</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.IpCoreConfig.namespace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.IpCoreConfig.version">
<code class="sig-name descname"><span class="pre">version</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.IpCoreConfig.version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyCAPI.FilesetConfig">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyCAPI.</span></code><code class="sig-name descname"><span class="pre">FilesetConfig</span></code><a class="reference internal" href="../_modules/pyCAPI.html#FilesetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyCAPI.FilesetConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>A Fileset is a group of sources of the same type, to be used together.</p>
<dl class="py attribute">
<dt id="pyCAPI.FilesetConfig.file_type">
<code class="sig-name descname"><span class="pre">file_type</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyCAPI.FilesetConfig.file_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.FilesetConfig.files">
<code class="sig-name descname"><span class="pre">files</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.FilesetConfig.files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.FilesetConfig.logical_name">
<code class="sig-name descname"><span class="pre">logical_name</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyCAPI.FilesetConfig.logical_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.FilesetConfig.path">
<code class="sig-name descname"><span class="pre">path</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></em><a class="headerlink" href="#pyCAPI.FilesetConfig.path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyCAPI.Config">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyCAPI.</span></code><code class="sig-name descname"><span class="pre">Config</span></code><a class="reference internal" href="../_modules/pyCAPI.html#Config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyCAPI.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Definition of the CAPI 3 format for core configuration files.</p>
<dl class="py attribute">
<dt id="pyCAPI.Config.CAPI">
<code class="sig-name descname"><span class="pre">CAPI</span></code><em class="property"><span class="pre">:</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.Config.CAPI" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.Config.filesets">
<code class="sig-name descname"><span class="pre">filesets</span></code><em class="property"><span class="pre">:</span> <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#pyCAPI.FilesetConfig" title="pyCAPI.FilesetConfig"><span class="pre">pyCAPI.FilesetConfig</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.Config.filesets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyCAPI.Config.ipcore">
<code class="sig-name descname"><span class="pre">ipcore</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#pyCAPI.IpCoreConfig" title="pyCAPI.IpCoreConfig"><span class="pre">pyCAPI.IpCoreConfig</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#pyCAPI.Config.ipcore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyCAPI.LoadCoreFile">
<code class="sig-prename descclassname"><span class="pre">pyCAPI.</span></code><code class="sig-name descname"><span class="pre">LoadCoreFile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coreFilePath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyCAPI.html#LoadCoreFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyCAPI.LoadCoreFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a CAPI 3 compliant core configuration file and unmarshal it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coreFilePath</strong> – location of the <code class="docutils literal notranslate"><span class="pre">*.core</span></code> file to be loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyCAPI.VUnit.AddCoreFilesets">
<code class="sig-prename descclassname"><span class="pre">pyCAPI.VUnit.</span></code><code class="sig-name descname"><span class="pre">AddCoreFilesets</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vunitHandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filesets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyCAPI/VUnit.html#AddCoreFilesets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyCAPI.VUnit.AddCoreFilesets" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the sources of some filesets from a CAPI 3 compliant core, into a VUnit
handle through VUnit’s API (<code class="docutils literal notranslate"><span class="pre">add_library</span></code> and <code class="docutils literal notranslate"><span class="pre">add_source_files</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vunitHandle</strong> – handle to the VUnit object instance.</p></li>
<li><p><strong>core</strong> – CAPI 3 compliant object (coming from LoadCoreFile).</p></li>
<li><p><strong>filesets</strong> – name of the filesets to be added into the VUnit handle.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="project.html" class="btn btn-neutral float-right" title="Project" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../intro/cosim.html" class="btn btn-neutral float-left" title="Co-simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Unai Martinez-Corral and contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/buildthedocs/sphinx.theme">theme</a>
    
    provided by <a href="https://buildthedocs.github.io">Build the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>